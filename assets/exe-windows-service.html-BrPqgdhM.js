import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,a,o as t}from"./app-DV62_j5_.js";const n={};function d(r,s){return t(),e("div",null,s[0]||(s[0]=[a('<p>记录 exe 程序做成 Windows 服务过程。</p><p>在<code>Windows</code>系统中，将一个<code>exe</code>程序作为服务运行，可以确保程序在系统启动时自动运行，并且在后台运行而不需要用户干预。以下是两种常见的方法来实现这一目标：使用<code>Windows</code>自带的<code>sc</code>命令和使用<code>instsrv + srvany</code>工具。</p><h2 id="使用sc命令" tabindex="-1"><a class="header-anchor" href="#使用sc命令"><span>使用sc命令</span></a></h2><p>打开命令提示符：以管理员身份运行cmd命令行窗口。</p><p>创建服务：输入以下命令，其中<code>myService</code>为服务名称，<code>binpath</code>为<code>exe</code>程序的绝对路径。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> myService</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binpath=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;C:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">path</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">to</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">your</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">program.exe&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>设置服务启动类型：打开系统服务，找到刚创建的服务，右键单击选择“属性”，将启动类型改为“自动”。</p><p>启动服务：在命令行中输入以下命令启动服务：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> myService</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>删除服务：如果需要删除服务，可以使用以下命令：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> delete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> myService</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="使用instsrv-srvany工具" tabindex="-1"><a class="header-anchor" href="#使用instsrv-srvany工具"><span>使用instsrv + srvany工具</span></a></h2><p>下载工具：从网上下载<code>instsrv.exe</code>和<code>srvany.exe</code>工具，并将它们拷贝到<code>C:\\\\Windows\\\\SysWOW64</code>目录下（如果是32位系统则拷贝到<code>C:\\\\Windows\\\\system32</code>目录下）。</p><p>创建服务：以管理员身份打开cmd，进入到工具所在目录，输入以下命令创建服务：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">instsrv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> myService</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> C:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Windows</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SysWOW64</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">srvany.exe</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>配置服务： 打开注册表编辑器（在cmd或Windows搜索中输入regedit）。 找到<code>HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\myService</code>，右键单击创建一个名为<code>Parameters</code>的新项。 在<code>Parameters</code>项中创建以下字符串值： <code>Application：exe</code>程序的绝对路径。 <code>AppDirectory：exe</code>程序所在的文件夹路径。 <code>AppParameters：</code>无需设置值。</p><p>设置服务启动类型：打开系统服务，找到创建的myService服务，将启动类型设置为“自动”。</p><p>通过以上两种方法，可以将任意exe程序作为<code>Windows</code>服务运行，确保程序在系统启动时自动运行，并在后台运行而不需要用户干预。</p>',18)]))}const l=i(n,[["render",d]]),p=JSON.parse('{"path":"/Windows/exe-windows-service.html","title":"Windows 服务制作","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"Windows 服务制作","description":"记录 exe 程序做成 Windows 服务过程。 在Windows系统中，将一个exe程序作为服务运行，可以确保程序在系统启动时自动运行，并且在后台运行而不需要用户干预。以下是两种常见的方法来实现这一目标：使用Windows自带的sc命令和使用instsrv + srvany工具。 使用sc命令 打开命令提示符：以管理员身份运行cmd命令行窗口。 创...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Windows 服务制作\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-07-31T01:15:16.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"slinjing\\",\\"url\\":\\"https://github.com/slinjing\\"}]}"],["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/docs-project/Windows/exe-windows-service.html"}],["meta",{"property":"og:site_name","content":"主页"}],["meta",{"property":"og:title","content":"Windows 服务制作"}],["meta",{"property":"og:description","content":"记录 exe 程序做成 Windows 服务过程。 在Windows系统中，将一个exe程序作为服务运行，可以确保程序在系统启动时自动运行，并且在后台运行而不需要用户干预。以下是两种常见的方法来实现这一目标：使用Windows自带的sc命令和使用instsrv + srvany工具。 使用sc命令 打开命令提示符：以管理员身份运行cmd命令行窗口。 创..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-07-31T01:15:16.000Z"}],["meta",{"property":"article:modified_time","content":"2025-07-31T01:15:16.000Z"}]]},"git":{"createdTime":1753781438000,"updatedTime":1753924516000,"contributors":[{"name":"https://github.com/slinjing/slinjing.github.io.git","username":"","email":"878057672@qq.com","commits":2}]},"readingTime":{"minutes":1.69,"words":506},"filePathRelative":"Windows/exe-windows-service.md","autoDesc":true}');export{l as comp,p as data};
